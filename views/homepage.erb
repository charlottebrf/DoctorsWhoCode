<!DOCTYPE html>

 <html>

	 <head>

	 	<!--This should help stuff show nicely on browsers and mobile, but we may not need it
	 	in a Sinatra template-->
 	 	<meta charset="utf-8">
	 	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	 	<meta name="viewport" content="width=500">

	 	<!--Boostrap must come before local css definitions-->
	 	<link href="./css/bootstrap.css" rel="stylesheet" type="text/css">
 	 	<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
	 	<link rel="stylesheet" href="./css/jquery-ui.css">
	 	<link href="./css/main.css" rel="stylesheet" type="text/css">

	 	<!--JQuery .js must come before Bootstrap .js, or stuff won't work-->
		<script src="./js/jquery-3.1.1.js"></script>
		<script src="./js/jquery-ui.js"></script>
		<script src="http://www.google.com/jsapi"></script>
    	<script src="./js/chartkick.js" type="text/javascript"></script>
		
		<script type="text/javascript">

  			$( function() {
    			
    			var availableActivities = [
					<% for row in @log_entries %>
						"<%= row["name"] %>",									  
					<% end %>
    			];
   
			    $( "#activity_to_log" ).autocomplete({
			      	source: availableActivities,
			      	position: {my : "center top+10", at: "bottom left", within: "window", collision: "none"},
				});
  
  			} );


			function validation_message() {

				var activity = document.getElementById("activity_to_log").value;
				var duration = document.getElementById("duration").value;
		       
		       	if (activity == "" || duration == ""){
		    		alert("Please fill out both fields");
		    		return true;
		    	}

		       	if (duration <= 0){
		    		alert("Please enter a valid duration");
		    		return true;
		    	}

			    else{
		       		alert("You logged " + duration + " minutes of " + activity);
		        	return true;
		    	}
			}

 		</script>

		<title>My Time Manager</title>

	</head>

	<body>

		<!--This is the navigation bar fixed to top of page-->
		<nav class="navbar navbar-inverse navbar-fixed-top" id="header-text">

	  		<!--not sure why container-fluid needs to be used, but documentation says use it-->
		    <div class="container-fluid">

			    <div class="navbar-header col-xs-12">

			     	<p>[Username]'s Time Manager</p>

			    </div>

			</div>

		<!--end of nav bar code-->
		</nav>

		<div class="container">

	    	<div class="row">

			    <div class="col-md-3 col-xs-1">			    	
				</div>

			    <div class="col-md-6 col-xs-10" id="log-activity-section">

			    	<h2>LOG ACTIVITY</h2>

					<form method="POST" name"myForm" onsubmit="return validation_message();" action="/log">

						<div class="form-group">

							<label class="control-label"></label>

							<div class="input-group col-md-6 col-xs-8">

								<span class="input-group-addon">How many minutes?</span>

								<input class="form-control" type="number" step="1" min="0" id="duration" name="duration" placeholder="" required="required">

							</div>

							<label class="control-label"></label>

							<div class="input-group col-md-12 col-xs-12">

								<span class="input-group-addon">Doing what?</span>

								<input class="form-control" type="text" maxlength="30" id="activity_to_log" name="activity_to_log" placeholder="Enter activity..."required="required">

							</div>

						</div>

			        	<button type="submit" class="btn btn-success">Log It</button>

					</form>

				</div>

			    <div class="col-md-3 col-xs-1">			    	
				</div>

			</div>
			<!--end of first row-->

			<!--start of second row-->
			<div class="row">

			    <div class="col-md-10 col-xs-10 activity-summary-graph">

			    	<h2>Activity Summary Graph</h2>
			    	<p>Figure out how to put a JS graph here, with padding/margin/centering as appropriate</p>
			    	<p>This is the data that should be charted: <%= @todays_raw_data %></p>

					<div>
					    <%= bar_chart(@graph_data) %>
					</div>

				</div>

			</div>
			<!--end of second row-->

			<!--start of third row-->
			<div class="row">

			    <div class="col-md-10 col-xs-10 activity-summary-text">

			    	<h2>Activity Summary Text</h2>

			    	<ul>
			    		<li>You spent the most time on [activity] ([duration] minutes)</li>
			    		<li>You spent the least time on [activity] ([duration] minutes)</li>
			    	</ul>

			    	<p><%= @graph_data %></p>

				</div>

			</div>
			<!--end of third row-->

		<!--this /div closes the container-->
	    </div>

	</body>

</html>
